{% extends 'base.html' %}

{% load crispy_forms_tags %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
  <div class="mb-3">
    <h1 class="h4">{{ title }}</h1>
    <p class="text-muted">Preencha os dados. As fotos são opcionais — envie até 10 imagens se desejar.</p>
  </div>

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    {% if form.non_field_errors %}
      <div class="alert alert-danger">
        <ul class="mb-0">
          {% for e in form.non_field_errors %}
            <li>{{ e }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <div class="row g-3">
      <div class="col-12 col-md-6">{# obra #}
        <label class="form-label">Obra</label>
        {{ form.obra }}
        {% for e in form.obra.errors %}
          <div class="invalid-feedback d-block">{{ e }}</div>
        {% endfor %}
      </div>
      <div class="col-12 col-md-6">{# fiscal #}
        <label class="form-label">Fiscal</label>
        {{ form.fiscal }}
        {% for e in form.fiscal.errors %}
          <div class="invalid-feedback d-block">{{ e }}</div>
        {% endfor %}
      </div>
      <div class="col-12 col-md-4">
        <label class="form-label">Data</label>
        {{ form.data_fiscalizacao }}
        {% for e in form.data_fiscalizacao.errors %}
          <div class="invalid-feedback d-block">{{ e }}</div>
        {% endfor %}
      </div>
      <div class="col-6 col-md-4">
        <label class="form-label">Clima</label>
        {{ form.clima }}
        {% for e in form.clima.errors %}
          <div class="invalid-feedback d-block">{{ e }}</div>
        {% endfor %}
      </div>
      <div class="col-6 col-md-4">
        <label class="form-label">Lixo</label>
        {{ form.lixo }}
        {% for e in form.lixo.errors %}
          <div class="invalid-feedback d-block">{{ e }}</div>
        {% endfor %}
      </div>

      <div class="col-12">
        <div class="form-check">
          {{ form.placa_instalada }} <label class="form-check-label ms-2">Placa instalada</label>
        </div>
      </div>
      <div class="col-12">
        <div class="form-check">
          {{ form.houve_ociosidade }} <label class="form-check-label ms-2">Houve ociosidade</label>
        </div>
        {{ form.observacao_ociosidade }}
        {% for e in form.observacao_ociosidade.errors %}
          <div class="invalid-feedback d-block">{{ e }}</div>
        {% endfor %}
      </div>
      <div class="col-12">
        <div class="form-check">
          {{ form.houve_retrabalho }} <label class="form-check-label ms-2">Houve retrabalho</label>
        </div>
        {{ form.motivo_retrabalho }}
        {% for e in form.motivo_retrabalho.errors %}
          <div class="invalid-feedback d-block">{{ e }}</div>
        {% endfor %}
      </div>

      <div class="col-12">
        <label class="form-label">Observações</label>
        {{ form.observacoes }}
        {% for e in form.observacoes.errors %}
          <div class="invalid-feedback d-block">{{ e }}</div>
        {% endfor %}
      </div>

      <div class="col-12">
        <label class="form-label">Fotos (opcional)</label>
        {{ form.fotos }}
        {% for e in form.fotos.errors %}
          <div class="invalid-feedback d-block">{{ e }}</div>
        {% endfor %}
        <div class="form-text">(Opcional) Use a câmera do celular para fotos diretas. Envie no máximo 10 imagens.</div>
      </div>

      <div class="col-12">
        <button class="btn btn-primary">Salvar fiscalização</button>
      </div>
    </div>
  </form>

  <!-- fotos are optional now; client-side enforcement removed -->

{% endblock %}
